<% include ../../partials/users/header.ejs %>
    <style>
        .statistic {
            width: 100%;
        }
    </style>
    <div class="ui cards segment" style="width:90%; margin-left:5%; margin-top:20px;">
        <div class="ui centered card">
            <div class="content">
                <div class="ui blue statistic">
                    <div class="value">₹
                        <%= user.moneyInHand.toLocaleString('en-IN') %>
                    </div>
                    <div class="label">Cash In Hand</div>
                </div>
            </div>
        </div>
        <div class="ui centered card">
            <div class="content">
                <div class="ui yellow statistic">
                    <div class="value">₹
                        <%= user.moneyInBet.toLocaleString('en-IN') %>
                    </div>
                    <div class="label">Money in Bets</div>
                </div>
            </div>
        </div>
        <div class="ui centered card">
            <div class="content">
                <div class="ui green statistic">
                    <div class="value">₹
                        <%= user.moneyWon.toLocaleString('en-IN') %>
                    </div>
                    <div class="label">Money Won</div>
                </div>
            </div>
        </div>
        <div class="ui centered card">
            <div class="content">
                <div class="ui red statistic">
                    <div class="value">₹
                        <%= user.moneyLost.toLocaleString('en-IN') %>
                    </div>
                    <div class="label">Money Lost</div>
                </div>
            </div>
        </div>
    </div>
    <div class="ui segment" style="width:44% !important; margin-right: 5%; margin-top:2%; float: right; overflow: scroll; height:50% !important;">
        <div class="ui header">Bet on Upcoming Matches</div>
        <table class="ui very basic collapsing selectable celled table" style="width:90%; margin-left:5%;">
            <thead>
                <tr>
                    <th style="text-align: right">Home Team</th>
                    <th style="text-align: center">Date/Result</th>
                    <th>Away Team</th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>
    <div class="ui segment" style="width:44% !important; margin-left: 5%; margin-top:2%;">
        <canvas id="myChart"></canvas>
    </div>


    <script>
        var ctx = document.getElementById("myChart");
        var myChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['5/4', '6/4', '7/4', '8/4', '9/4', '10/4', '11/4', '12/4', '13/4', '14/4'],
                datasets: [{
                    tension: 0.1,
                    label: 'Cash in Hand',
                    data: [20000, 50000, 25000, 10000, 27635, 39883, 62352, 78232, 99382, 54678],
                    backgroundColor: [
                        'rgba(255, 255, 255, 0.2)'
                    ],
                    borderColor: [
                        'rgba(255,99,132,1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true
                        }
                    }]
                }
            }
        });
    </script>
    <script>
        $.ajax('/apis/match/undeclared', {
            success: function (data) {
                var upcomingMatches = JSON.parse(data);
                var parent = document.querySelector('.ui.very.basic.collapsing.selectable.celled.table tbody');
                for (var i = 0; i < upcomingMatches.length; i++) {
                    var match = upcomingMatches[i];
                    var tr = document.createElement('tr');
                    tr.setAttribute('id', match.id);
                    tr.setAttribute('style', 'cursor:pointer');
                    tr.addEventListener('click', function (oEvent) {
                        console.log(oEvent.currentTarget.id);
                    });

                    var tdHome = document.createElement('td');
                    tdHome.setAttribute('style', 'text-align:right !important');
                    var h4Home = document.createElement('h4');
                    h4Home.setAttribute('class', 'ui image header');
                    var divHomeContent = document.createElement('div');
                    divHomeContent.setAttribute('class', 'content');
                    divHomeContent.appendChild(document.createTextNode(match.home.shortName));
                    var divHomeSubHeader = document.createElement('div');
                    divHomeSubHeader.setAttribute('class', 'sub header');
                    divHomeSubHeader.textContent = match.home.name;
                    divHomeContent.appendChild(divHomeSubHeader);
                    var imgHome = document.createElement('img');
                    imgHome.setAttribute('src', '/images/' + match.home.shortName.toLowerCase() + '.png');
                    imgHome.setAttribute('class', 'ui mini rounded image');
                    imgHome.setAttribute('style', 'padding-left: 5px');
                    h4Home.appendChild(divHomeContent);
                    h4Home.appendChild(imgHome);
                    tdHome.appendChild(h4Home);

                    var tdMiddle = document.createElement('td');
                    var h4Middle = document.createElement('h4');
                    h4Middle.setAttribute('class', 'ui header');
                    h4Middle.setAttribute('style', 'text-align: center !important');
                    var divMiddleContent = document.createElement('div');
                    divMiddleContent.setAttribute('class', 'content');
                    var divMiddleSubHeader = document.createElement('div');
                    divMiddleSubHeader.setAttribute('class', 'sub header');
                    if (match.result) {
                        divMiddleContent.appendChild(document.createTextNode(match.result.won + ' won'));
                        divMiddleSubHeader.textContent = 'by ' + match.result.by;
                    } else {
                        divMiddleContent.appendChild(document.createTextNode(match.fixture.date));
                        divMiddleSubHeader.textContent = match.fixture.time;
                    }
                    divMiddleContent.appendChild(divMiddleSubHeader);
                    h4Middle.appendChild(divMiddleContent);
                    tdMiddle.appendChild(h4Middle);

                    var tdAway = document.createElement('td');
                    var h4Away = document.createElement('h4');
                    h4Away.setAttribute('class', 'ui image header');
                    var divAwayContent = document.createElement('div');
                    divAwayContent.setAttribute('class', 'content');
                    divAwayContent.appendChild(document.createTextNode(match.away.shortName));
                    var divAwaySubHeader = document.createElement('div');
                    divAwaySubHeader.setAttribute('class', 'sub header');
                    divAwaySubHeader.textContent = match.away.name;
                    divAwayContent.appendChild(divAwaySubHeader);
                    var imgAway = document.createElement('img');
                    imgAway.setAttribute('src', '/images/' + match.away.shortName.toLowerCase() + '.png');
                    imgAway.setAttribute('class', 'ui mini rounded image');
                    h4Away.appendChild(imgAway);
                    h4Away.appendChild(divAwayContent);
                    tdAway.appendChild(h4Away);

                    tr.appendChild(tdHome);
                    tr.appendChild(tdMiddle);
                    tr.appendChild(tdAway);

                    parent.appendChild(tr);
                }
            }
        });
    </script>
    <% include ../../partials/users/footer.ejs %>